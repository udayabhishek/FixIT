<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="utf-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1">
    <!-- The above 3 meta tags *must* come first in the head; any other head content must come *after* these tags -->
    <title>Screen 34</title>

    <!-- Bootstrap -->
    <link href="css/bootstrap.min.css" rel="stylesheet">
    <link href="css/style.css" rel="stylesheet">
    <link rel="stylesheet" href="css/font-awesome.css">
    
    <script src="https://ajax.googleapis.com/ajax/libs/jquery/1.11.3/jquery.min.js"></script>
    <script type="text/javascript" src="cordova.js"></script>
	<script type="text/javascript" src="js/internet_connection.js"></script>
   	<!-- <script type="text/javascript" src="js/credit.js"></script> -->
     <!-- <script src="jquery.creditCardValidator.js"></script> -->
     
    <style>
    	.active{color: #f48221 !important;}
    </style>
    <script>
    	$(document).ready(function(){
    	$("#ntg").click(function(){
	    	$("a").removeClass("active");
	    	});
    	});
    </script>
    
	<script type="text/javascript">
	
	//Validation For All the Fields
	function validateCCname() 
    {
		var regx = /^[A-Za-z][-a-zA-Z ]+$/; 
		var cname=document.paymentDetails.ccname.value;
				if( cname == "" )
				   {
					 //document.paymentDetails.ccname.focus() ;
				     document.getElementById("errorBox_creditcard").innerHTML = "Enter Credit Card Name";
				     return false;
				   }
				else if(cname.length < 3 || cname.length > 51 )
				   {
		    	  	 document.getElementById("errorBox_creditcard").innerHTML = "Credit Card Name Must contain 3 to 50 Characters";
		    	     return false;
				   }
				else if(!regx.test(cname))
			 	   {
		    	     document.getElementById("errorBox_creditcard").innerHTML = "Card Name must contain characters only.";
		    	     return false;
				   }
				else
				   {
				   	  document.getElementById("errorBox_creditcard").innerHTML = "";
				   }
		return true;
    }
		//Validation For Credit card Number
	function validateCCnumber() 
    {
		var cardno=document.paymentDetails.cardno.value;
		var pvisa = /^(?:4[0-9]{12}(?:[0-9]{3})?)$/;
        var pmaster= /^(?:5[1-5][0-9]{14})$/;
        var pdinner = /^(?:3(?:0[0-5]|[68][0-9])[0-9]{11})$/;
        var pdiscover = /^(?:6(?:011|5[0-9][0-9])[0-9]{12})$/;
        var pjcb = /^(?:(?:2131|1800|35\d{3})\d{11})$/;
        var pamerica = /^(?:3[47][0-9]{13})$/;
        var cardno_len=cardno.length;
		        if( cardno == "" )
				   {
					 //document.paymentDetails.cardno.focus() ;
				     document.getElementById("errorBox_cardno").innerHTML = "Enter Credit Card Number";
				     return false;
				   }
		        else if(!(cardno.match(pvisa) || cardno.match(pmaster) || cardno.match(pdinner) || cardno.match(pdiscover) || cardno.match(pjcb) || cardno.match(pamerica)))
		        	{
					   document.getElementById("errorBox_cardno").innerHTML ="Not a valid  credit card number";
			           return false;
			      	}  
			   
				 else
					{
					   document.getElementById("errorBox_cardno").innerHTML = "";
					}
	    
	   
		return true;
    }
		//Validation For Expiry Date
	function validateExpDate() 
    {
		var today = new Date();
		var month=today.getMonth();
		var year=today.getFullYear();
		var expmonth=document.paymentDetails.month.value;
		var expyear=document.paymentDetails.date.value;
		if(expmonth != "Select Month" && expyear != "Select Year"){
				if (((month >= expmonth)||(month >= expmonth)) && (year >=expyear))
				{
				    document.getElementById("errorBox_expdate").innerHTML="Card already expired!";
				    return false;
				} 
				else
				{
				    document.getElementById("errorBox_expdate").style.display='none';
				}
		}
		 else if(expmonth == "Select Month" && expyear == "Select Year")
		 {
			document.getElementById("errorBox_expdate").innerHTML="Select month and year";
			return false;
		 } 
		
		else 
		{
			document.getElementById("errorBox_expdate").innerHTML = "";
			
		}
		return true;
    }
		//Validation For Security Code
	function validateSeccode() 
    {
		var scode=document.paymentDetails.seccode.value;
		var cvvno=/^[0-9]{3,4}$/; 
		
				if( scode == "" )
				   {
					 //document.paymentDetails.seccode.focus() ;
				     document.getElementById("errorBox_seccode").innerHTML = "Enter Security code";
				     return false;
				   }
				else if(!(cvvno.test(scode)))
				{
				   document.getElementById("errorBox_seccode").innerHTML = "Invalid Security code";
				   return false;
				} 
				 
				else
				{
		 		   document.getElementById("errorBox_seccode").innerHTML = "";
				}
	
		return true;
    }
		//Validation For Zip Code
	
		
	function saveDetails() 
    {
		var regx = /^[A-Za-z][-a-zA-Z ]+$/; 
		var cname=document.paymentDetails.ccname.value;
		var cardno=document.paymentDetails.cardno.value;
		var expmonth=document.paymentDetails.month.value;
		var expyear=document.paymentDetails.date.value;
		var scode=document.paymentDetails.seccode.value;
		var cardno_len=cardno.length;
		var isValid = /(^\d{5}$)|(^\d{5}-\d{4}$)/;
		var pvisa = /^(?:4[0-9]{12}(?:[0-9]{3})?)$/;
        var pmaster= /^(?:5[1-5][0-9]{14})$/;
        var pdinner = /^(?:3(?:0[0-5]|[68][0-9])[0-9]{11})$/;
        var pdiscover = /^(?:6(?:011|5[0-9][0-9])[0-9]{12})$/;
        var pjcb = /^(?:(?:2131|1800|35\d{3})\d{11})$/;
        var pamerica = /^(?:3[47][0-9]{13})$/;
		var cvvno=/^[0-9]{3,4}$/; 
		if(validateCCname() && validateCCnumber() && validateExpDate() && validateSeccode())
   	  	{
			var pick=sessionStorage.getItem('pick');
			var $ccname=$('#ccid').val();
            var $cardnum = $('#cardnum').val();
            var $month = $('#month').val();
            var $year = $('#year').val();
            var $seccode = $('#scode').val();
            var oid = localStorage.getItem('oid');
     		var newDate = new Date();
     		var day = getWeekDay(newDate);
     		var hours = newDate.getHours();
     		//alert("pick is : "+ pick);
			if(pick=='fixit')
			{
	                   
	                    var wecanfixtext=sessionStorage.getItem('wecanfixtext');
	        			var image_paths=sessionStorage.getItem('image_paths');
	        			var help=sessionStorage.getItem('help');
	        			var userlocation=sessionStorage.getItem('userlocation');
	        			var data = sessionStorage.getItem('data');
	        			var pincode=sessionStorage.getItem("pincode");
	        			/* alert('oid='+oid+'&issue='+wecanfixtext+'&photo='
        						+image_paths+'&howfast='+help+'&location='
        						+userlocation+'&pick=fixit&kindOfWork='+data
        						+'&zipcode='+pincode+'&day='+day+'&time='
        						+hours+'&creditcard_name='+$ccname+'&creditcard_number='+$cardnum+'&expiration_month='+$month+'&expiration_year='+$year+'&security_code='+$seccode); */
	        			$.ajax({
	        				type:"POST",
	        				url:"http://in.shikshainfotech.com/FixIT/postajob.php?",
	        				data:'oid='+oid+'&issue='+wecanfixtext+'&photo='
	        						+image_paths+'&howfast='+help+'&location='
	        						+userlocation+'&pick=fixit&kindOfWork='+data
	        						+'&zipcode='+pincode+'&day='+day+'&time='
	        						+hours+'&creditcard_name='+$ccname+'&creditcard_number='+$cardnum+'&expiration_month='+$month+'&expiration_year='+$year+'&security_code='+$seccode,
	        				   success : function(data) {
	        					//alert("data is : "+ data);
	        					//alert("data length is: "+data.length);
	        					var jsdata_str = JSON.stringify(data);
	        					var jsdata_obj = JSON.parse(jsdata_str);
	        					var jid = jsdata_obj.jid;
	        					// alert("jid is :" + jid);
	        					sessionStorage.setItem('jid', jid);
	        					//$('#fixit_pick').modal({backdrop: 'static', keyboard: false});
	        					window.location = "slide6.html";
	        				},
	        				error : function(jqXHR, textStatus, errorThrown) {
	        					alert('Error' + errorThrown + textStatus + jqXHR);
	        					//window.location="slide4.html";
	        				}
	        			});
	                 	
   	     }
			else if(pick=='own')
			{
				var wecanfixtext=sessionStorage.getItem('wecanfixtext');
				var image_paths=sessionStorage.getItem('image_paths');
				var help=sessionStorage.getItem('help');
				var userlocation=sessionStorage.getItem('userlocation');
				var pids=sessionStorage.getItem('pid');
				//alert('oid='+oid+'&issue='+wecanfixtext+'&photo='+image_paths+'&howfast='+help+'&location='+userlocation+'&pick=own&pids='+pids+'&creditcard_name='+$ccname+'&creditcard_number='+$cardnum+'&expiration_month='+$month+'&expiration_year='+$year+'&security_code='+$seccode);
				 $.ajax({
                     type: "POST",
                     url:"http://in.shikshainfotech.com/FixIT/postajob.php?",
                     data:'oid='+oid+'&issue='+wecanfixtext+'&photo='+image_paths+'&howfast='+help+'&location='+userlocation+'&pick=own&pids='+pids+'&creditcard_name='+$ccname+'&creditcard_number='+$cardnum+'&expiration_month='+$month+'&expiration_year='+$year+'&security_code='+$seccode,
                     success: function (data) 
                     {
                   	  var jsdata_str=JSON.stringify(data);
                         var jsdata_obj=JSON.parse(jsdata_str);
                        // alert(jsdata_obj);
                         var jid=jsdata_obj.jid;
                        // alert("jid:" +jid);
                   	sessionStorage.setItem('jid',jid);
                   	window.location = "slide6.html";
                   	//$('#owner_pick').modal({backdrop: 'static', keyboard: false});
                   	//alert("msgclick");
                   	//myMsgClickHandler;
                 	  } 
                 });  
			}
   	  	}
    }
	function getWeekDay(date) {
		var days = [ '1', '2', '3', '4', '5', '6', '7' ]
		return days[date.getDay()]
	}
	</script>
	<script>
    $('#ccid').on('keyup blur',function(){ 
    var node = $(this);
    node.val(node.val().replace(/[^A-Za-z]/g,'') );
    });
    
    $("#scode").keypress(function(){
        var value = $(this).val();
        value = value.replace(/[^0-9]+/g, '');
        $(this).val(value);
    });
    
   /*  $("#zipcode").keypress(function(){
        var value = $(this).val();
        value = value.replace(/[^0-9]+/g, '');
        $(this).val(value);
    }); */
    </script>
	
 	<script type="text/javascript"> 
	//Identify Credit Card Type based on Credit card number
	function getCardType(number)
	{
    // visa
	   var pvisa = /^(?:4[0-9]{12}(?:[0-9]{3})?)$/;
	   var pmaster= /^(?:5[1-5][0-9]{14})$/;
	   var pdinner = /^(?:3(?:0[0-5]|[68][0-9])[0-9]{11})$/;
	   var pdiscover = /^(?:6(?:011|5[0-9][0-9])[0-9]{12})$/;
	   var pjcb = /^(?:(?:2131|1800|35\d{3})\d{11})$/;
	   var pamerica = /^(?:3[47][0-9]{13})$/;
   //Identify Visa Type
	    if (number.match(pvisa) != null)
			{
	    	
	    	var image='<img src="img/visa-active.png">';
	    	document.getElementById("image").innerHTML=image;
	        return false;
			}
	    else
	    	{
	    	var img='<img src="img/card_placeholder.png">';
	    	document.getElementById("image").innerHTML=img;
	    	}
	   
	  //Identify MasterCard Type
	   if (number.match(pmaster) != null)
	    	{
			 var image='<img src="img/master-active.png">';
			 document.getElementById("image").innerHTML=image;
		     return false;
	    	}
	   else
			{
			var img='<img src="img/card_placeholder.png">';
			document.getElementById("image").innerHTML=img;
			}
	    
	   //Identify America Express Type
	  
	    if (number.match(pamerica) != null)
	    	{
	    	 var image='<img src="img/amex-active.png">';
	    	 document.getElementById("image").innerHTML=image;
		     return false;
	    	}
	    else
			{
			var img='<img src="img/card_placeholder.png">';
			document.getElementById("image").innerHTML=img;
			}
	    // //Identify Discover Type
	    
	    if (number.match(pdiscover) != null)
	    	{
	    	var image='<img src="img/discover-active.png">';
			document.getElementById("image").innerHTML=image;
		    return false;
	    	}
	    else
			{
			var img='<img src="img/card_placeholder.png">';
			document.getElementById("image").innerHTML=img;
			}
	    
	    // //Identify Diners Type
	    
	    if (number.match(pdinner) != null)
	    	{
	    	var image='<img src="img/diners-active.png">';
			document.getElementById("image").innerHTML=image;
			return false;
	    	}
	    else
			{
			var img='<img src="img/card_placeholder.png">';
			document.getElementById("image").innerHTML=img;
			}
	   
	    
	   //Identify JCB Type
	    if (number.match(pjcb) != null)
	    {
	    	var image='<img src="img/jcb-active.png">';
		    document.getElementById("image").innerHTML=image;
			return false;
	    }	
	    else
			{
			var img='<img src="img/card_placeholder.png">';
			document.getElementById("image").innerHTML=img;
			}
    return "";
	}
	</script>  
  </head>
  <body>
<!--    <nav class="navbar navbar-inverse" role="navigation">-->
<!--            <div class="col-xs-8 col-sm-6 text-right" style="color:#fff;padding-top: 10px; float-right"><h4>Fixit Pro Sign-Up</h4></div>-->
<!--    </nav>-->
<nav class="navbar navbar-inverse navbar-fixed-top" role="navigation">
    <!-- <div class="container"> -->
    <!-- Brand and toggle get grouped for better mobile display -->
    <div class="col-xs-2 col-sm-2 text-left"
        style="color: #fff;  padding: 10px 0 0 10px  ; ">
        <button type="button" class="navbar-toggle" data-toggle="collapse"
            id="back-button-id" >
            <i class="fa fa-chevron-left"></i>
        </button>
    </div>
    <div class="col-xs-8 col-sm-8 text-center"
        style="color: #fff; padding-top: 15px;">
        <h4>Sign-Up</h4>
    </div>
    <div class="col-xs-2 col-sm-2  navbar-header text-right" style="padding-top: 10px;">
        <!--        <button type="button" class="navbar-toggle" data-toggle="collapse"-->
        <!--            id="settings_button">-->
        <!--            <span class="sr-only">Toggle navigation</span> <span-->
        <!--                class="icon-bar"></span> <span class="icon-bar"></span> <span-->
        <!--                    class="icon-bar"></span>-->
        <!--        </button>-->
        <!-- <a class="navbar-brand" href="#">Start Bootstrap</a> -->
    </div>
</nav>


    <section style="color:#000; margin-top:90px;">
      <form name="paymentDetails">
      <div id="submitBox"></div>
      <div class="container" id="MarginBottom">
        <div class="form-group">
          <label for="exampleInputEmail1">Register your card and connect to service providers </label>
        </div>
      
       
       <div class="panel-group" id="accordion" role="tablist" aria-multiselectable="true">
		  <div class="panel panel-default">
		    <div class="panel-heading" role="tab" id="headingOne">
		      <h4 class="panel-title">
		      <a role="button" data-toggle="collapse" data-parent="#accordion" href="#collapseOne" aria-expanded="true" aria-controls="collapseOne" id="ntg">
		        <!-- <a role="button" data-toggle="collapse" data-parent="#accordion" href="#collapseOne" aria-expanded="true" aria-controls="collapseOne"> -->
		          Pay with PayPal
		        </a>
		      </h4>
		    </div>
		    <div id="collapseOne" class="panel-collapse collapse" role="tabpanel" aria-labelledby="headingOne">
		      <div class="panel-body">
		        This functionality is under development.It will be available shortly.
		      </div>
		    </div>
		  </div>
		  <div class="panel panel-default">
		    <div class="panel-heading" role="tab" id="headingTwo">
		      <h4 class="panel-title">
		      <a class="collapsed in active" role="button" data-toggle="collapse" data-parent="#accordion" href="#collapseTwo" aria-expanded="false" aria-controls="collapseTwo">
		        <!-- <a class="collapsed in" role="button" data-toggle="collapse" data-parent="#accordion" href="#collapseTwo" aria-expanded="false" aria-controls="collapseTwo"> -->
		          Pay with Credit Card
		        </a>
		      </h4>
		    </div>		    
		    <div id="collapseTwo" class="panel-collapse collapse in" role="tabpanel" aria-labelledby="headingTwo">
		      <div class="panel-body">
		      
		        <div class="form-group">
		        	<label for="exampleInputEmail1">Name on Credit Card</label>
		          	<input type="text" name="ccname" class="form-control" id="ccid" onkeyup="this.value=this.value.replace(/[^A-Za-z_ ]/g,'');" onblur="return validateCCname();">
		          	<div id="errorBox_creditcard" class="alertField"></div>		        	
		        </div>
		        <div class="form-group">
		        	<div class="row">
				        <div class="col-xs-12 col-sm-12">
				          <label for="exampleInputEmail1">Card Number</label>
				        </div>
				        <div class="col-xs-9 col-sm-9">
				          <input type="number" name="cardno" class="form-control" id="cardnum" maxlength="16" onblur="return getCardType(this.value); " onchange="return validateCCnumber();" onkeyup="if(this.value.length>19){this.value='this.value';}" >
				        </div>
				       
				        <div class="col-xs-3 col-sm-3" id="image">
				        	 <!-- <img src="img/master-active.png" class="img-responsive"> -->
				        </div> 
		           		
		        	</div>
		        	 <div id="errorBox_cardno" class="alertField"></div>
		        </div>
		        <div class="form-group">
		          <div class="row">
		            <div class="col-md-12"><label for="exampleInputEmail1" >Expiration Date</label></div>
		            <div class="col-xs-6 col-sm-6">
		              <select class="form-control" name="month" id="month" onchange="validateExpDate();" >
		              	<option>Select Month</option>
		                <option>01</option>
		                <option>02</option>
		                <option>03</option>
		                <option>04</option>
		                <option>05</option>
		                <option>06</option>
		                <option>07</option>
		                <option>08</option>
		                <option>09</option>
		                <option>10</option>
		                <option>11</option>
		                <option>12</option> 
		              </select>
		              
		            </div>
		            <div class="col-xs-6 col-sm-6">
		              <select class="form-control" name="date" id="year" onchange="validateExpDate();" >
		              	<option>Select Year</option>
		                <option>2015</option>
		                <option>2016</option>
		                <option>2017</option>
		                <option>2018</option>
		                <option>2019</option>
		                <option>2020</option>
		                <option>2021</option>
		                <option>2022</option>
		                <option>2023</option>
		                <option>2024</option>
		                <option>2025</option>
		                <option>2026</option>
		                <option>2027</option>
		                <option>2028</option>
		                <option>2029</option>
		                <option>2030</option>
		                <option>2031</option>
		                <option>2032</option>
		                <option>2033</option>
		                <option>2034</option>
		                <option>2035</option>
		              </select>
		             
		            </div>
		          </div>
		           <div id="errorBox_expdate" class="alertField"></div>
		        </div>
		        <div class="form-group">
		         
		              <label for="exampleInputEmail1">Security Code</label>
		              <input type="number" name="seccode" class="form-control" id="scode" maxlength="4" onkeypress="this.value=this.value.replace(/[^0-9]+/g, '');" onblur="return validateSeccode();">
		               <div id="errorBox_seccode" class="alertField"></div>
		        </div>
		      </div>
		    </div>
		    
		  </div>
		</div>
      </div>


      <div class="modal-footer navbar-fixed-bottom" id="button">
        <div class="btn-group btn-group-justified" role="group" aria-label="group button">
          <div class="btn-group" role="group" >
            <button type="button" class="btn btn-default" role="button" id="mybutt" onclick="saveDetails()">Done</button>
          </div>
          <!-- <div class="btn-group" role="group" id="google">
            <button type="button" id="saveImage" class="btn btn-default btn-hover-green" data-action="save" role="button">Log in with <i class="fa fa-google-plus fa-lg"></i></button>
          </div> --> 
        </div>
      </div>

      <!-- <a href="slide18.html"><div id="button"><div class="bottom-button-bg text-center"><button class="btn btn-default">Submit</button></div></div></a>
 -->
      </form>
    </section>
   

    <!-- jQuery (necessary for Bootstrap's JavaScript plugins) -->
    <script src="https://ajax.googleapis.com/ajax/libs/jquery/1.11.3/jquery.min.js"></script>
    <!-- Include all compiled plugins (below), or include individual files as needed -->
    <script src="js/bootstrap.min.js"></script>
    <script>
        $("#back-button-id").click(function(){
                    window.location="slide28.html";
        });
                                   
        
        
        
      $(function() {
          $("#selectedFile").on("change", function()
          {
              var files = !!this.files ? this.files : [];
              if (!files.length || !window.FileReader) return; // no file selected, or no FileReader support
       
              if (/^image/.test( files[0].type)){ // only image file
                  var reader = new FileReader(); // instance of the FileReader
                  reader.readAsDataURL(files[0]); // read the local file
       
                  reader.onloadend = function(){ // set image data as background of div
                      $("#imagePreview").css("background-image", "url("+this.result+")");
                  }
              }
          });
      });
    </script>
  </body>
</html>





