<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="utf-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1">
    <!-- The above 3 meta tags *must* come first in the head; any other head content must come *after* these tags -->
    <title>Slide 28</title>

    <!-- Bootstrap -->
    <link href="css/bootstrap.min.css" rel="stylesheet">
    <link href="css/style.css" rel="stylesheet">
    <link rel="stylesheet" href="css/font-awesome.css">
    <!-- HTML5 shim and Respond.js for IE8 support of HTML5 elements and media queries -->
    <!-- WARNING: Respond.js doesn't work if you view the page via file:// -->
    <!--[if lt IE 9]>
      <script src="https://oss.maxcdn.com/html5shiv/3.7.2/html5shiv.min.js"></script>
      <script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
    <![endif]-->
  </head>
  <body style="overflow-x:hidden !important;" onload="profile();">
   
    <nav class="navbar navbar-inverse navbar-fixed-top" role="navigation">
        <!-- <div class="container"> -->
        <!-- Brand and toggle get grouped for better mobile display -->
        <div class="col-xs-2 col-sm-2 text-left"
            style="color: #fff;  padding: 10px 0 0 10px  ; ">
            <button type="button" class="navbar-toggle" data-toggle="collapse"
                id="back-button-id" >
                <i class="fa fa-chevron-left"></i>
            </button>
        </div>
        <div class="col-xs-8 col-sm-8 text-center"
            style="color: #fff; padding-top: 15px;">
            <h4>Settings</h4>
        </div>
        <div class="col-xs-2 col-sm-2  navbar-header text-right" style="padding-top: 10px;">
  
        </div>
    </nav>

    <section style="margin-top:75px;color:#000" id="slide28" style="overflow-x:hidden !important;">
      <form>
      <div class="container">
        <div class="row text-center" style="width:98%; margin:0 auto; ">
           
                 <div class="col-xs-4 col-sm-4 prof-margin" id="imagediv">
                                  <div id="imagePreview" class="img-circle img-H-W"  
									data-toggle="modal" data-target="#myModal" style="width:50px; height:50px;"></div>
                               </div>
             <!--    <div class="uplload-button">
                <div id="deviceready">
                
                <p class="event listening" style="display: none;"></p>
                <p class="event received" style="display: none;"></p>
                  <input type="file" id="selectedFile"
                    name="selectedFile" style="display: none;" />
                </div>
               
              </div> -->  
              <div class="modal fade" id="myModal">
                <div class="modal-dialog">
                  <div class="modal-content text-center">
                    <div class="ModelTopBorder"><h4 style="background-color: #ccc;margin: 0px;padding: 10px 0px;">Complete Action Using</h4></div>
                    <div class="modal-body text-center">
                        <div class="row">
                          <div class="col-sm-6 col-xs-6" >
                            <div class="text-center" id="camera_option">
                              <div><i class="fa fa-camera fa-5x"></i></div>
                              <div><label>Camera</label></div>
                            </div>
                          </div>
                          <div class="col-sm-6 col-xs-6">
                            <div class="text-center" id="gallery_option">
                              <div><i class="fa fa-picture-o fa-5x"></i></div>
                              <div id="deviceready">                
                                  <p class="event listening" style="display: none;"></p>
                                  <p class="event received" style="display: none;"></p>
                              </div>
                              <div><label>Gallery</label></div>
                            </div>
                          </div>
                        </div>
                    </div>                      
                    <div class="modal-footer" id="ModalButton">
                      <div class="btn-group btn-group-justified" role="group" aria-label="group button">
                        <div class="btn-group" role="group">
                          <button type="button" class="btn btn-default" role="button" data-dismiss="modal">CANCEL</button>
                        </div>
                      </div>
                    </div> 
                  </div>
                </div>
              </div>                 
            </div>
            <div class="row text-center user-details" style="width:98%; margin:0 auto;">
                <div class="col-md-12 col-sm-12 col xs-12 text-center">
                    <h4 id="fullname"></h4>
                </div>
                <div class="col-md-12 col-sm-12 col xs-12 text-center">
                    <label id="viewprofile">view profile</label>
                </div>
            </div>
        </div>        
      
    <div class="row text-center text-bold" style="width:99%; margin:0 auto; ">
        <ul class="list-group">
          <li class="list-group-item" id="post_jobs">Post a Job</li>
          <li class="list-group-item" id="payment_options">Payment Options</li>
          <li class="list-group-item" id="list_promotion">Promotions</li>
          <li class="list-group-item" id="previous_jobs">Previous Job</li>
          <li class="list-group-item" id="list_support">Support</li>
          <li class="list-group-item" id="list_about">About</li>
          
          <li class="list-group-item" id="logout">LogOut</li> 
        </ul>
    </div>

<!--      <div class="modal-footer" id="button">-->
<!--        <div class="btn-group btn-group-justified" role="group" aria-label="group button">-->
<!--         <!--  <div class="btn-group" role="group">-->
<!--            <button type="button" class="btn btn-default" role="button">Log Out</button>-->
<!--          </div> -->
<!--          <!-- <div class="btn-group btn-delete hidden" role="group">-->
<!--            <button type="button" id="delImage" class="btn btn-default btn-hover-red" data-dismiss="modal"  role="button">Delete</button>-->
<!--          </div>-->
<!--          <div class="btn-group" role="group">-->
<!--            <button type="button" id="saveImage" class="btn btn-default btn-hover-green" data-action="save" role="button">Save</button>-->
<!--          </div> -->
<!--        </div>-->
<!--      </div>-->

      <!-- <a href="slide18.html"><div id="button"><div class="bottom-button-bg text-center"><button class="btn btn-default">Submit</button></div></div></a>
 -->
      </form>
    </section>

    <!-- jQuery (necessary for Bootstrap's JavaScript plugins) -->
    <script src="https://ajax.googleapis.com/ajax/libs/angularjs/1.4.3/angular.min.js"></script>
    <script src="http://code.ionicframework.com/1.0.1/js/ionic.min.js"></script>
    <script type="text/javascript" src="cordova.js"></script>
	<script type="text/javascript" src="js/internet_connection.js"></script>
    <script src="js/jquery.min.js"></script>
    <!-- Include all compiled plugins (below), or include individual files as needed -->
    <script src="js/bootstrap.min.js"></script>
    <script>
    $("#back-button-id").click(function(){
           // window.location="slide2.html";
                var slide = sessionStorage.getItem("slide");
                               var page = slide+".html";
                
                window.location = page;
               // window.history.go(-1);
    });
        
    /*
      $(function() {
          $("#selectedFile").on("change", function()
          {
              var files = !!this.files ? this.files : [];
              if (!files.length || !window.FileReader) return; // no file selected, or no FileReader support
       
              if (/^image/.test( files[0].type)){ // only image file
                  var reader = new FileReader(); // instance of the FileReader
                  reader.readAsDataURL(files[0]); // read the local file
       
                  reader.onloadend = function(){ // set image data as background of div
                      $("#imagePreview").css("background-image", "url("+this.result+")");
                  }
              }
          });
      });*/
    
    </script>
    <script type="text/javascript">

        window.onload = function profile()
        {
            
        	sessionStorage.setItem("previous_job_12","1");
			//alert("pics is :"+ sessionStorage.getItem('homeowner_profilepic'));
          if(sessionStorage.getItem('homeowner_profilepic')!=null)
          {
              var profilepic = sessionStorage.getItem('homeowner_profilepic');
             // alert("profilepic"+profilepic);
              var imageURL = "http://in.shikshainfotech.com/FixIT/uploads/houseowner-profile-images/";
              var image = imageURL+profilepic;
             // alert("image is : "+ image);
              function escapeShell_Args (cmd) {
                return '\'' + cmd.replace(/\'/g, "'\\''") + '\'';
              }
              $("#imagePreview").css("background-image", "url("+escapeShell_Args(image)+")");
          }
                                          else if(sessionStorage.getItem('googleplus_profilepic')!=null)
                                          {
                                          var profilepic = sessionStorage.getItem('googleplus_profilepic');
                                          var imageURL = "http://in.shikshainfotech.com/FixIT/uploads/houseowner-profile-images/";
                                          var image = profilepic;
                                          // alert("image is : "+ image);
                                          function escapeShell_Args (cmd) {
                                          return '\'' + cmd.replace(/\'/g, "'\\''") + '\'';
                                                                    }
                                                                    $("#imagePreview").css("background-image", "url("+escapeShell_Args(image)+")");
                                                                    }
                                                                    
                                                                    else if(sessionStorage.getItem('facebook_profilepic')!=null)
                                                                    {
                                                                    var profilepic = sessionStorage.getItem('facebook_profilepic');
                                                                    var imageURL = "http://in.shikshainfotech.com/FixIT/uploads/houseowner-profile-images/";
                                                                    var image = profilepic;
                                                                    function escapeShell_Args (cmd) {
                                                                    return '\'' + cmd.replace(/\'/g, "'\\''") + '\'';
                                                                                              }
                                                                                              $("#imagePreview").css("background-image", "url("+escapeShell_Args(image)+")");
                                                                                              }
                  
        }

                                          
        function openFileBrowser1(imag){
                sessionStorage.setItem('ImageId',imag);
                navigator.camera.getPicture(onPhotoDataSuccess, onFail, {
                                                                      
                    destinationType: Camera.DestinationType.FILE_URI,
                    sourceType: Camera.PictureSourceType.PHOTOLIBRARY,
                });
                //alert("uri: "+Camera.DestinationType.FILE_URI);
        }
                                          
                                          
       /* function openFileBrowser(){
        
       // alert("open file browser4 called...");
        var deviceInformation = ionic.Platform.version();//fetch the device operating system
        var currentPlatform = ionic.Platform.platform(); //fetch the device OS version
       
            var app = {
                  // Application Constructor
                  initialize: function() {
                      this.bindEvents();
                  },
                  // Bind Event Listeners
                  //
                  // Bind any events that are required on startup. Common events are:
                  // 'load', 'deviceready', 'offline', and 'online'.
                  bindEvents: function() {
                      document.addEventListener('deviceready', this.onDeviceReady, false);
                  },
                  
                  onDeviceReady: function() {
                      app.receivedEvent('deviceready');
                  },
                  // Update DOM on a Received Event
                  receivedEvent: function(id) {
                      var parentElement = document.getElementById(id);
                      var listeningElement = parentElement.querySelector('.listening');
                      var receivedElement = parentElement.querySelector('.received');

                      listeningElement.setAttribute('style', 'display:none;');
                      receivedElement.setAttribute('style', 'display:block;');

                      console.log('Received Event: ' + id);
                      
            function escapeShellArg (cmd) {
                return '\'' + cmd.replace(/\'/g, "'\\''") + '\'';
            }

                      var success = function(data) {
                        console.log( data.filepath );
                        var fileURL= data.filepath;

                       
             $("#imagePreview").css("background-image", "url("+escapeShellArg(fileURL)+")");
 
                        var win = function (r) {

                            
                            console.log("Code = " + r.responseCode);
                            console.log("Response = " + r.response);
                            console.log("Sent = " + r.bytesSent);
                           
                            var serverpath=JSON.parse(r.response); 

                            //alert("Server path : "+serverpath.path);
                            //alert("Response :"+r.response);
                            //alert("Server path : "+serverpath.path);
                           // sessionStorage.setItem('homeownerimage',serverpath.path);
                        }

                        var fail = function (error) {
                            //alert("An error has occurred: Code = " + error.code);
                            console.log("upload error source " + error.source);
                            console.log("upload error target " + error.target);
                        }

                        var oid = localStorage.getItem('oid');
                       // alert("OID :"+oid);
                        var options = new FileUploadOptions();
                        
                       // alert("File Upload Options Called");
                        options.fileKey = "fileToUpload";
                        options.fileName = fileURL.substr(fileURL.lastIndexOf('/') + 1);
                        options.mimeType = "image/jpg";

                        var params = new Object();
                        params.oid = oid;
                        //params.value2 = "param";

                        options.params = params;
                         
                        var ft = new FileTransfer();
                        ft.upload(fileURL, encodeURI("http://in.shikshainfotech.com//FixIT/houseownerphotoupload.php?"), win, fail, options);

                    };
                
                    var error = function(msg) {
                        console.log( msg );
                    };
                
                    filechooser.open({},success,error);
                      
                  }
              };

             app.initialize();
      
        }*/

            var pictureSource;   // picture source
            var destinationType; // sets the format of returned value
            document.addEventListener("deviceready",onDeviceReady,false);
           // alert("openCameraOptions called1");
            function onDeviceReady() {
            pictureSource=navigator.camera.PictureSourceType;
            destinationType=navigator.camera.DestinationType;
            }

           function onPhotoDataSuccess(imageData) {
             
                var img = sessionStorage.getItem('ImageId');
                                          
                sessionStorage.setItem(img,imageData);
                                                                                              alert("imagedata "+imageData);
                function escapeShellArg (cmd) {
                                                                                              alert("cmd is  "+ cmd);
                            return '\'' + cmd.replace(/\'/g, "'\\''") + '\'';
                        }
               $("#imagePreview").css("background-image", "url("+escapeShellArg(imageData)+")");
               

               var win = function (r) {
                                                      //alert("response from server is "+JSON.stringify(r));
                                console.log("Code = " + r.responseCode);
                                console.log("Response = " + r.response);
                                console.log("Sent = " + r.bytesSent);
                                var serverpath=JSON.parse(r.response)
                                alert("Server path : "+serverpath.path);
                                //sessionStorage.setItem('',serverpath.path);
                            }

                            var fail = function (error) {
                                                     // alert("error "+ JSON.stringify(error));
                                console.log("upload error source " + error.source);
                                console.log("upload error target " + error.target);
                            }
                                                      var oid= localStorage.getItem('oid');
                            var options = new FileUploadOptions();
                                                      //alert("options are "+JSON.stringify(options));
                            options.fileKey = "fileToUpload";
                            options.fileName = imageData.substr(imageData.lastIndexOf('/') + 1);
                            options.mimeType = "image/jpg";
                            
                            //var params = {};
                            //params.value1 = "test";
                            //params.value2 = "param";
                                                      var params = new Object();
                                                      params.oid = oid;
                                                      //params.value2 = "param";
                                                      
                                                      options.params = params;
                            var ft = new FileTransfer();
                            ft.upload(imageData, encodeURI("http://in.shikshainfotech.com/FixIT/houseownerphotoupload.php?"), win, fail, options);
 
            }

           function capturePhoto() {
                                                      //alert("i am called in capturephoto");
                 navigator.camera.getPicture(onPhotoDataSuccess, onFail, { quality: 50, destinationType: Camera.DestinationType.FILE_URI });

            }

            function onFail(message) {

                alert('Failed because: ' + message);
            }

          var $regname = localStorage.getItem('firstname');
          //alert("$regname :"+$regname);
          if(sessionStorage.getItem('new_fname')==null)
          {
            //alert("old");
            $("#fullname").text($regname); 
          }
          else if(sessionStorage.getItem('new_fname')!=null)
          {
            //alert("new");
            var newfname = sessionStorage.getItem('new_fname');
            //alert("new :"+newfname);
            $("#fullname").text(newfname); 
          }
       


            $("#viewprofile").click(function(){
            var oid = localStorage.getItem('oid');
           // alert("oid is : "+ oid);
            $.ajax({
                 type: "POST",
                 url: "http://in.shikshainfotech.com/FixIT/houseownerviewprofile.php?",
                 data:'oid='+oid,
                 success: function (data) { 
               // alert("darta is "+JSON.stringify(data));
                 var image = data.profilepic;
                 //alert('image :'+image);
                 sessionStorage.setItem('homeownerimage',image);
                 sessionStorage.setItem('owner',oid);
                 window.location="slide31.html"

                 },
                 error: function (jqXHR, textStatus, errorThrown) 
                 {
                 //alert('Error'+ errorThrown + textStatus + jqXHR);                 
                 }
              }); 
       

        });
            
       
        $("#camera_option").click(function(){
         
        $('#myModal').modal('hide');
        capturePhoto();

  });

       $("#gallery_option").click(function(){

       $('#myModal').modal('hide');
       openFileBrowser1();
      
  });
</script>
    
<script>
// IMAGE COMPRESSION
    // returns a function that calculates lanczos weight
    function lanczosCreate(lobes) {
        return function(x) {
            if (x > lobes)
            return 0;
            x *= Math.PI;
            if (Math.abs(x) < 1e-16)
            return 1;
            var xx = x / lobes;
            return Math.sin(x) * Math.sin(xx) / x / xx;
        };
    }

// elem: canvas element, img: image element, sx: scaled width, lobes: kernel radius
function thumbnailer(elem, img, sx, lobes) {
    this.canvas = elem;
    elem.width = img.width;
    elem.height = img.height;
    elem.style.display = "none";
    this.ctx = elem.getContext("2d");
    this.ctx.drawImage(img, 0, 0);
    this.img = img;
    this.src = this.ctx.getImageData(0, 0, img.width, img.height);
    this.dest = {
        width : sx,
        height : Math.round(img.height * sx / img.width),
    };
    this.dest.data = new Array(this.dest.width * this.dest.height * 3);
    this.lanczos = lanczosCreate(lobes);
    this.ratio = img.width / sx;
    this.rcp_ratio = 2 / this.ratio;
    this.range2 = Math.ceil(this.ratio * lobes / 2);
    this.cacheLanc = {};
    this.center = {};
    this.icenter = {};
    setTimeout(this.process1, 0, this, 0);
}

thumbnailer.prototype.process1 = function(self, u) {
    self.center.x = (u + 0.5) * self.ratio;
    self.icenter.x = Math.floor(self.center.x);
    for (var v = 0; v < self.dest.height; v++) {
        self.center.y = (v + 0.5) * self.ratio;
        self.icenter.y = Math.floor(self.center.y);
        var a, r, g, b;
        a = r = g = b = 0;
        for (var i = self.icenter.x - self.range2; i <= self.icenter.x + self.range2; i++) {
            if (i < 0 || i >= self.src.width)
            continue;
            var f_x = Math.floor(1000 * Math.abs(i - self.center.x));
            if (!self.cacheLanc[f_x])
            self.cacheLanc[f_x] = {};
            for (var j = self.icenter.y - self.range2; j <= self.icenter.y + self.range2; j++) {
                if (j < 0 || j >= self.src.height)
                continue;
                var f_y = Math.floor(1000 * Math.abs(j - self.center.y));
                if (self.cacheLanc[f_x][f_y] == undefined)
                self.cacheLanc[f_x][f_y] = self.lanczos(Math.sqrt(Math.pow(f_x * self.rcp_ratio, 2)
                                                                  + Math.pow(f_y * self.rcp_ratio, 2)) / 1000);
                                                                  weight = self.cacheLanc[f_x][f_y];
                                                                  if (weight > 0) {
                                                                      var idx = (j * self.src.width + i) * 4;
                                                                      a += weight;
                                                                      r += weight * self.src.data[idx];
                                                                      g += weight * self.src.data[idx + 1];
                                                                      b += weight * self.src.data[idx + 2];
                                                                  }
            }
        }
        var idx = (v * self.dest.width + u) * 3;
        self.dest.data[idx] = r / a;
        self.dest.data[idx + 1] = g / a;
        self.dest.data[idx + 2] = b / a;
    }
    
    if (++u < self.dest.width)
    setTimeout(self.process1, 0, self, u);
    else
    setTimeout(self.process2, 0, self);
};
thumbnailer.prototype.process2 = function(self) {
    self.canvas.width = self.dest.width;
    self.canvas.height = self.dest.height;
    self.ctx.drawImage(self.img, 0, 0, self.dest.width, self.dest.height);
    self.src = self.ctx.getImageData(0, 0, self.dest.width, self.dest.height);
    var idx, idx2;
    for (var i = 0; i < self.dest.width; i++) {
        for (var j = 0; j < self.dest.height; j++) {
            idx = (j * self.dest.width + i) * 3;
            idx2 = (j * self.dest.width + i) * 4;
            self.src.data[idx2] = self.dest.data[idx];
            self.src.data[idx2 + 1] = self.dest.data[idx + 1];
            self.src.data[idx2 + 2] = self.dest.data[idx + 2];
        }
    }
    self.ctx.putImageData(self.src, 0, 0);
    self.canvas.style.display = "block";
};
        
</script>
<script type="text/javascript">

        $("#payment_options").click(function(){

          window.location="creditCardEdit.html"
        });
        
        $("#list_promotion").click(function(){

         window.location="slide30-Fixit.html"
        });
        
        $("#previous_jobs").click(function(){
         
         window.location="slide12.html"
        });
        
        $("#post_jobs").click(function(){
         sessionStorage.setItem("slide","slide28");
         window.location="slide3.html"
               
        // window.location="slide2.html"
                              
        });
        
        $("#list_support").click(function(){
         
         window.location="slide29.html"
        });
        
        $("#list_about").click(function(){
        
        window.location="slide30-Fixit.html"
        });
        
        $("#logout").click(function()
        {
           var oid= localStorage.getItem('oid');
           //alert("oid : "+ oid);
        	$.ajax({
                type: "POST",
                url: "http://in.shikshainfotech.com/FixIT/houseowner_logout.php?",
                data:'oid='+oid,
                success: function (data) 
                { 
                    //alert("data is "+JSON.stringify(data));
                    localStorage.clear();
                    sessionStorage.setItem('logout_back','1');
                    window.location="slide32.html";
                }	
        	});
        	
        	
        	
        });
        
    </script>

  </body>
</html>