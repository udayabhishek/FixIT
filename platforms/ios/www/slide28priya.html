<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="utf-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1">
    <!-- The above 3 meta tags *must* come first in the head; any other head content must come *after* these tags -->
    <title>Slide 28</title>

    <!-- Bootstrap -->
    <link href="css/bootstrap.min.css" rel="stylesheet">
    <link href="css/style.css" rel="stylesheet">
    <link rel="stylesheet" href="css/font-awesome.css">
    <!-- HTML5 shim and Respond.js for IE8 support of HTML5 elements and media queries -->
    <!-- WARNING: Respond.js doesn't work if you view the page via file:// -->
    <!--[if lt IE 9]>
      <script src="https://oss.maxcdn.com/html5shiv/3.7.2/html5shiv.min.js"></script>
      <script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
    <![endif]-->
  </head>
  <body onload="profile();setting_back_pressed();" style="margin:0 auto;color:#000;width:90%;">
    <nav class="navbar navbar-inverse navbar-fixed-top" role="navigation">
            <!-- Brand and toggle get grouped for better mobile display -->
            <div class="col-xs-12 col-sm-12 text-center" style="color:#fff;padding-top: 10px; float-right"><h4>Settings</h4></div>
            <!-- <div class="col-xs-4 col-sm-6  navbar-header">
                <button type="button" class="navbar-toggle" data-toggle="collapse" data-target="#bs-example-navbar-collapse-1">
                    <span class="sr-only">Toggle navigation</span>
                    <span class="icon-bar"></span>
                    <span class="icon-bar"></span>
                    <span class="icon-bar"></span>
                </button>

            </div> -->
    </nav>


    <section style="margin:65px auto;color:#000;" id="slide28">
      <form>
      <div class="container" >
        <div class="row text-center">
            <div class="row">
                 <div class="col-xs-4 col-sm-4 prof-margin" id="imagediv">
                                  <div id="imagePreview" class="img-circle img-H-W"  
									data-toggle="modal" data-target="#myModal" style="width:50px; height:50px;"></div>
                               </div>
             <!--    <div class="uplload-button">
                <div id="deviceready">
                
                <p class="event listening" style="display: none;"></p>
                <p class="event received" style="display: none;"></p>
                  <input type="file" id="selectedFile"
                    name="selectedFile" style="display: none;" />
                </div>
               
              </div> -->  
              <div class="modal fade" id="myModal">
                <div class="modal-dialog">
                  <div class="modal-content text-center">
                    <div class="ModelTopBorder"><h4 style="background-color: #ccc;margin: 0px;padding: 10px 0px;">Complete Action Using</h4></div>
                    <div class="modal-body text-center">
                        <div class="row">
                          <div class="col-sm-6 col-xs-6" >
                            <div class="text-center" id="camera_option">
                              <div><i class="fa fa-camera fa-5x"></i></div>
                              <div><label>Camera</label></div>
                            </div>
                          </div>
                          <div class="col-sm-6 col-xs-6">
                            <div class="text-center" id="gallery_option">
                              <div><i class="fa fa-picture-o fa-5x"></i></div>
                              <div id="deviceready">                
                                  <p class="event listening" style="display: none;"></p>
                                  <p class="event received" style="display: none;"></p>
                              </div>
                              <div><label>Gallery</label></div>
                            </div>
                          </div>
                        </div>
                    </div>                      
                    <div class="modal-footer" id="ModalButton">
                      <div class="btn-group btn-group-justified" role="group" aria-label="group button">
                        <div class="btn-group" role="group">
                          <button type="button" class="btn btn-default" role="button" data-dismiss="modal">CANCEL</button>
                        </div>
                      </div>
                    </div> 
                  </div>
                </div>
              </div>                 
            </div>
            <div class="row text-center user-details">
                <div class="col-md-12 col-sm-12 col xs-12 text-center">
                    <h4 id="fullname"></h4>
                </div>
                <div class="col-md-12 col-sm-12 col xs-12 text-center">
                    <label id="viewprofile">View Profile</label>
                </div>
            </div>
        </div>        
      </div>
    <div class="row text-center text-bold">
        <ul class="list-group">
          <li class="list-group-item" id="post_jobs">Post a Job</li>
          <li class="list-group-item" id="payment_options">Payment Options</li>
          <li class="list-group-item" id="list_promotion">Promotions</li>
          <li class="list-group-item" id="previous_jobs">Previous Job</li>
          <li class="list-group-item" id="list_support">Support</li>
          <li class="list-group-item" id="list_about">About</li>
          <li class="list-group-item" id="logout">LogOut</li> 
        </ul>
    </div>

    <!--   <div class="modal-footer" id="button">
        <div class="btn-group btn-group-justified" role="group" aria-label="group button">
          <div class="btn-group" role="group">
            <button type="button" class="btn btn-default" role="button">Log Out</button>
          </div>
          <div class="btn-group btn-delete hidden" role="group">
            <button type="button" id="delImage" class="btn btn-default btn-hover-red" data-dismiss="modal"  role="button">Delete</button>
          </div>
          <div class="btn-group" role="group">
            <button type="button" id="saveImage" class="btn btn-default btn-hover-green" data-action="save" role="button">Save</button>
          </div>
        </div>
      </div> -->

      <!-- <a href="slide18.html"><div id="button"><div class="bottom-button-bg text-center"><button class="btn btn-default">Submit</button></div></div></a>
 -->
      </form>
    </section>

    <!-- jQuery (necessary for Bootstrap's JavaScript plugins) -->
    <script src="https://ajax.googleapis.com/ajax/libs/angularjs/1.4.3/angular.min.js"></script>
    <script src="http://code.ionicframework.com/1.0.1/js/ionic.min.js"></script>
    <script type="text/javascript" src="cordova.js"></script>
	<script type="text/javascript" src="js/internet_connection.js"></script>
    <script src="js/jquery.min.js"></script>
    <!-- Include all compiled plugins (below), or include individual files as needed -->
    <script src="js/bootstrap.min.js"></script>
    <script>
      $(function() {
          $("#selectedFile").on("change", function()
          {
              var files = !!this.files ? this.files : [];
              if (!files.length || !window.FileReader) return; // no file selected, or no FileReader support
       
              if (/^image/.test( files[0].type)){ // only image file
                  var reader = new FileReader(); // instance of the FileReader
                  reader.readAsDataURL(files[0]); // read the local file
       
                  reader.onloadend = function(){ // set image data as background of div
                      $("#imagePreview").css("background-image", "url("+this.result+")");
                  }
              }
          });
      });
    </script>
    <script type="text/javascript">

        function profile()
        {
        	sessionStorage.setItem("previous_job_12","1");
          if(sessionStorage.getItem('homeowner_profilepic')!=null)
          {
              var profilepic = sessionStorage.getItem('homeowner_profilepic');
              var imageURL = "http://in.shikshainfotech.com/FixIT/uploads/houseowner-profile-images/";
              var image = imageURL+profilepic;
             // alert("image is : "+ image);
              function escapeShell_Args (cmd) {
                return '\'' + cmd.replace(/\'/g, "'\\''") + '\'';
              }
              $("#imagePreview").css("background-image", "url("+escapeShell_Args(image)+")");
          }
          else if(sessionStorage.getItem('googleplus_profilepic')!=null)
          {
              var profilepic = sessionStorage.getItem('googleplus_profilepic');
              var imageURL = "http://in.shikshainfotech.com/FixIT/uploads/houseowner-profile-images/";
              var image = profilepic;
             // alert("image is : "+ image);
              function escapeShell_Args (cmd) {
                return '\'' + cmd.replace(/\'/g, "'\\''") + '\'';
              }
              $("#imagePreview").css("background-image", "url("+escapeShell_Args(image)+")");
          }
          
          else if(sessionStorage.getItem('facebook_profilepic')!=null)
          {
              var profilepic = sessionStorage.getItem('facebook_profilepic');
              var imageURL = "http://in.shikshainfotech.com/FixIT/uploads/houseowner-profile-images/";
              var image = profilepic;
              function escapeShell_Args (cmd) {
                return '\'' + cmd.replace(/\'/g, "'\\''") + '\'';
              }
              $("#imagePreview").css("background-image", "url("+escapeShell_Args(image)+")");
          }
        }

        function openFileBrowser(){
        
       // alert("open file browser4 called...");
        var deviceInformation = ionic.Platform.version();//fetch the device operating system
        var currentPlatform = ionic.Platform.platform(); //fetch the device OS version
       
            var app = {
                  // Application Constructor
                  initialize: function() {
                      this.bindEvents();
                  },
                  // Bind Event Listeners
                  //
                  // Bind any events that are required on startup. Common events are:
                  // 'load', 'deviceready', 'offline', and 'online'.
                  bindEvents: function() {
                      document.addEventListener('deviceready', this.onDeviceReady, false);
                  },
                  
                  onDeviceReady: function() {
                      app.receivedEvent('deviceready');
                  },
                  // Update DOM on a Received Event
                  receivedEvent: function(id) {
                      var parentElement = document.getElementById(id);
                      var listeningElement = parentElement.querySelector('.listening');
                      var receivedElement = parentElement.querySelector('.received');

                      listeningElement.setAttribute('style', 'display:none;');
                      receivedElement.setAttribute('style', 'display:block;');

                      console.log('Received Event: ' + id);
                      
            function escapeShellArg (cmd) {
                return '\'' + cmd.replace(/\'/g, "'\\''") + '\'';
            }

                      var success = function(data) {
                        console.log( data.filepath );
                        var fileURL= data.filepath;

                       
             $("#imagePreview").css("background-image", "url("+escapeShellArg(fileURL)+")");
 
                        var win = function (r) {

                            
                            console.log("Code = " + r.responseCode);
                            console.log("Response = " + r.response);
                            console.log("Sent = " + r.bytesSent);
                           
                            var serverpath=JSON.parse(r.response); 

                            //alert("Server path : "+serverpath.path);
                            //alert("Response :"+r.response);
                            //alert("Server path : "+serverpath.path);
                           // sessionStorage.setItem('homeownerimage',serverpath.path);
                        }

                        var fail = function (error) {
                            //alert("An error has occurred: Code = " + error.code);
                            console.log("upload error source " + error.source);
                            console.log("upload error target " + error.target);
                        }

                        var oid = localStorage.getItem('oid');
                       // alert("OID :"+oid);
                        var options = new FileUploadOptions();
                        
                       // alert("File Upload Options Called");
                        options.fileKey = "fileToUpload";
                        options.fileName = fileURL.substr(fileURL.lastIndexOf('/') + 1);
                        options.mimeType = "image/jpg";

                        var params = new Object();
                        params.oid = oid;
                        //params.value2 = "param";

                        options.params = params;
                         
                        var ft = new FileTransfer();
                        ft.upload(fileURL, encodeURI("http://in.shikshainfotech.com/FixIT/houseownerphotoupload.php?"), win, fail, options);

                    };
                
                    var error = function(msg) {
                        console.log( msg );
                    };
                
                    filechooser.open({},success,error);
                      
                  }
              };

             app.initialize();
      
        }

            var pictureSource;   // picture source
            var destinationType; // sets the format of returned value
            document.addEventListener("deviceready",onDeviceReady,false);
           // alert("openCameraOptions called1");
            function onDeviceReady() {
            pictureSource=navigator.camera.PictureSourceType;
            destinationType=navigator.camera.DestinationType;
            }

           function onPhotoDataSuccess(imageData) {
             

               
                function escapeShellArg (cmd) {
                            return '\'' + cmd.replace(/\'/g, "'\\''") + '\'';
                        }
               $("#imagePreview").css("background-image", "url("+escapeShellArg(imageData)+")");
               

               var win = function (r) {
                                console.log("Code = " + r.responseCode);
                                console.log("Response = " + r.response);
                                console.log("Sent = " + r.bytesSent);
                                var serverpath=JSON.parse(r.response)
                                //alert("Server path : "+serverpath.path);
                                sessionStorage.setItem('profileimage',serverpath.path);
                            }

                            var fail = function (error) {
                                
                                console.log("upload error source " + error.source);
                                console.log("upload error target " + error.target);
                            }

                            var options = new FileUploadOptions();
                            
                            options.fileKey = "fileToUpload";
                            options.fileName = imageData.substr(imageData.lastIndexOf('/') + 1);
                            options.mimeType = "image/jpg";
                            
                            var params = {};
                            params.value1 = "test";
                            params.value2 = "param";
                           
                            var ft = new FileTransfer();
                            ft.upload(imageData, encodeURI("http://in.shikshainfotech.com/FixIT/houseownerphotoupload.php?"), win, fail, options);
 
            }

           function capturePhoto() {

                 navigator.camera.getPicture(onPhotoDataSuccess, onFail, { quality: 50, destinationType: Camera.DestinationType.FILE_URI });

            }

            function onFail(message) {

                //alert('Failed because: ' + message);
            }

          var $regname = localStorage.getItem('firstname');
          var edit_profile=localStorage.getItem("edit_profile");
          var $gmailname=localStorage.getItem('gmailname');
          var $fbname=localStorage.getItem('fbname');
          //alert("edit_profile "+edit_profile);
         // alert("$regname :"+$regname+" $gmailname "+$gmailname+" $fbname "+$fbname);
          if(edit_profile==1)
          {
	          if(sessionStorage.getItem('new_fname')==null)
	          {
	            //alert("old");
	            $("#fullname").text($regname); 
	          }
	          else if(sessionStorage.getItem('new_fname')!=null)
	          {
	            //alert("new");
	            var newfname = sessionStorage.getItem('new_fname');
	            //alert("new :"+newfname);
	            $("#fullname").text(newfname); 
	          }
          }
          else if(edit_profile==3)
          {
        	  //alert(sessionStorage.getItem('new_fname'));
        	  if(sessionStorage.getItem('new_fname')==null)
              {
                //alert("old");
                $("#fullname").text($fbname); 
              }
              else if(sessionStorage.getItem('new_fname')!=null)
              {
                //alert("new");
                var newfname = sessionStorage.getItem('new_fname');
                //alert("new :"+newfname);
                $("#fullname").text(newfname); 
              }
        	  
          }
          else if(edit_profile==2)
          {
        	 // alert(sessionStorage.getItem('new_fname'));
        	  if(sessionStorage.getItem('new_fname')==null)
              {
                //alert("old");
                $("#fullname").text($gmailname); 
              }
              else if(sessionStorage.getItem('new_fname')!=null)
              {
                //alert("new");
                var newfname = sessionStorage.getItem('new_fname');
                //alert("new :"+newfname);
                $("#fullname").text(newfname); 
              }
        	  
          }
       


            $("#viewprofile").click(function(){
            var oid = localStorage.getItem('oid');
           // alert("oid is : "+ oid);
            $.ajax({
                 type: "POST",
                 url: "http://in.shikshainfotech.com/FixIT/houseownerviewprofile.php?",
                 data:'oid='+oid,
                 success: function (data) { 
               // alert("darta is "+JSON.stringify(data));
                 var image = data.profilepic;
                 //alert('image :'+image);
                 sessionStorage.setItem('homeownerimage',image);
                 sessionStorage.setItem('owner',oid);
                 window.location="slide31.html"

                 },
                 error: function (jqXHR, textStatus, errorThrown) 
                 {
                 //alert('Error'+ errorThrown + textStatus + jqXHR);                 
                 }
              }); 
       

        });
            
       
        $("#camera_option").click(function(){
         
        $('#myModal').modal('hide');
        capturePhoto();

  });

       $("#gallery_option").click(function(){

       $('#myModal').modal('hide');
       openFileBrowser();
      
  });
</script>
<script type="text/javascript">

        $("#payment_options").click(function(){

          window.location="creditCardEdit.html"
        });
        
        $("#list_promotion").click(function(){

         window.location="slide30-Fixit.html"
        });
        
        $("#previous_jobs").click(function(){
         
         window.location="slide12.html"
        });
        
        $("#post_jobs").click(function(){
            
         window.location="slide2.html"
        });
        
        $("#list_support").click(function(){
         
         window.location="slide29.html"
        });
        
        $("#list_about").click(function(){
        
        window.location="slide30-about.html"
        });
        
        $("#logout").click(function()
        {
           var oid= localStorage.getItem('oid');
           //alert("oid : "+ oid);
        	$.ajax({
                type: "POST",
                url: "http://in.shikshainfotech.com/FixIT/houseowner_logout.php?",
                data:'oid='+oid,
                success: function (data) 
                { 
                    //alert("data is "+JSON.stringify(data));
                    localStorage.clear();
                    sessionStorage.clear();
                    sessionStorage.setItem('logout_back','1');
                    window.location="slide32.html";
                }	
        	});
        	
        	
        	
        });
        
        function setting_back_pressed()
	    {
	    	document.addEventListener("deviceready", onDeviceReady, false); 


	    	function onDeviceReady() {
	    	//alert ('i am called');
	    	document.addEventListener('backbutton', onBackKeyDown, false);
	    	}
	    	function onBackKeyDown(e) {

	    	    //alert("back pressed");
	    	  e.preventDefault();
	    	  var slide=sessionStorage.getItem("slide");
	    	  window.location=slide+".html";
	    	}

	    }
    </script>

  </body>
</html>